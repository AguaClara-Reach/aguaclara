

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aguaclara.core.physchem &mdash; AguaClara v0.2.3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/youtube.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/youtube.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> AguaClara
          

          
          </a>

          
            
            
              <div class="version">
                v0.2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../core/core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../research/research.html">Research</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AguaClara</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>aguaclara.core.physchem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aguaclara.core.physchem</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Contains functions pertaining to the design of physical and chemical unit</span>
<span class="sd">processes of AguaClara water treatment plants.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">aguaclara.core.units</span> <span class="kn">import</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">aguaclara.core.constants</span> <span class="k">as</span> <span class="nn">con</span>
<span class="kn">import</span> <span class="nn">aguaclara.core.utility</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="kn">import</span> <span class="nn">aguaclara.core.pipes</span> <span class="k">as</span> <span class="nn">pipe</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1">############################ Gas ##############################</span>


<div class="viewcode-block" id="density_air"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.density_air">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">density_air</span><span class="p">(</span><span class="n">Pressure</span><span class="p">,</span> <span class="n">MolarMass</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `density_air` is deprecated; use `density_gas` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;density_air is deprecated; use density_gas instead.&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">density_gas</span><span class="p">(</span><span class="n">Pressure</span><span class="p">,</span> <span class="n">MolarMass</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">)</span></div>


<div class="viewcode-block" id="density_gas"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.density_gas">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">density_gas</span><span class="p">(</span><span class="n">Pressure</span><span class="p">,</span> <span class="n">MolarMass</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the density of air at the given pressure, molar mass, and</span>
<span class="sd">    temperature.</span>

<span class="sd">    :param Pressure: pressure of air in the system</span>
<span class="sd">    :type Pressure: u.pascal</span>
<span class="sd">    :param MolarMass: molar mass of air in the system</span>
<span class="sd">    :type MolarMass: u.gram/u.mol</span>
<span class="sd">    :param Temperature: Temperature of air in the system</span>
<span class="sd">    :type Temperature: u.degK</span>

<span class="sd">    :return: density of air in the system</span>
<span class="sd">    :rtype: u.kg/u.m**3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Pressure</span> <span class="o">*</span> <span class="n">MolarMass</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Temperature</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span></div>

<span class="c1">########################## Geometry ###########################</span>


<div class="viewcode-block" id="area_circle"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.area_circle">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">area_circle</span><span class="p">(</span><span class="n">DiamCircle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the area of a circle given its diameter.</span>

<span class="sd">    :param DiamCircle: diameter of circle</span>
<span class="sd">    :type DiamCircle: u.m</span>

<span class="sd">    :return: area of circle</span>
<span class="sd">    :rtype: u.m**2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">DiamCircle</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;DiamCircle&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">DiamCircle</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_circle"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_circle">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_circle</span><span class="p">(</span><span class="n">AreaCircle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the diameter of a circle given its area.</span>

<span class="sd">    :param AreaCircle: area of circle</span>
<span class="sd">    :type AreaCircle: u.m**2</span>

<span class="sd">    :return: diameter of circle</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">AreaCircle</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;AreaCircle&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">AreaCircle</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span></div>

<span class="c1">####################### Water Properties #######################</span>


<span class="c1">#:</span>
<span class="n">RE_TRANSITION_PIPE</span> <span class="o">=</span> <span class="mi">2100</span>

<span class="c1">#: Table of temperatures and the corresponding water density.</span>
<span class="c1">#:</span>
<span class="c1">#: WATER_DENSITY_TABLE[0] is a list of water temperatures, in Kelvin.</span>
<span class="c1">#: WATER_DENSITY_TABLE[1] is the corresponding densities, in kg/m³.</span>
<span class="n">WATER_DENSITY_TABLE</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">273.15</span><span class="p">,</span> <span class="mf">278.15</span><span class="p">,</span> <span class="mf">283.15</span><span class="p">,</span> <span class="mf">293.15</span><span class="p">,</span> <span class="mf">303.15</span><span class="p">,</span> <span class="mf">313.15</span><span class="p">,</span>
                        <span class="mf">323.15</span><span class="p">,</span> <span class="mf">333.15</span><span class="p">,</span> <span class="mf">343.15</span><span class="p">,</span> <span class="mf">353.15</span><span class="p">,</span> <span class="mf">363.15</span><span class="p">,</span> <span class="mf">373.15</span>
                        <span class="p">),</span> <span class="p">(</span><span class="mf">999.9</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">999.7</span><span class="p">,</span> <span class="mf">998.2</span><span class="p">,</span> <span class="mf">995.7</span><span class="p">,</span> <span class="mf">992.2</span><span class="p">,</span>
                            <span class="mf">988.1</span><span class="p">,</span> <span class="mf">983.2</span><span class="p">,</span> <span class="mf">977.8</span><span class="p">,</span> <span class="mf">971.8</span><span class="p">,</span> <span class="mf">965.3</span><span class="p">,</span> <span class="mf">958.4</span>
                            <span class="p">)</span>
                       <span class="p">]</span>


<div class="viewcode-block" id="viscosity_dynamic"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.viscosity_dynamic">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">viscosity_dynamic</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `viscosity_dynamic` is deprecated; use `viscosity_dynamic_water`</span>
<span class="sd">        instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;viscosity_dynamic is deprecated; use &#39;</span>
                  <span class="s1">&#39;viscosity_dynamic_water instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">viscosity_dynamic_water</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></div>


<div class="viewcode-block" id="viscosity_dynamic_water"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.viscosity_dynamic_water">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">viscosity_dynamic_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the dynamic viscosity of water at a given temperature.</span>

<span class="sd">    :param Temperature: temperature of water</span>
<span class="sd">    :type Temperature: u.degK</span>

<span class="sd">    :return: dynamic viscosity of water</span>
<span class="sd">    :rtype: u.kg/(u.m*u.s)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Temperature</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature in Kelvin&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="mf">2.414</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">247.8</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degK</span> <span class="o">/</span>
                                                    <span class="p">(</span><span class="n">Temperature</span> <span class="o">-</span> <span class="mi">140</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degK</span><span class="p">))</span></div>


<div class="viewcode-block" id="density_water"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.density_water">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">density_water</span><span class="p">(</span><span class="n">Temperature</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the density of water at a given temperature.</span>

<span class="sd">    :param Temperature: temperature of water</span>
<span class="sd">    :type Temperature: u.degK</span>

<span class="sd">    :param temp: deprecated; use Temperature instead</span>

<span class="sd">    :return: density of water</span>
<span class="sd">    :rtype: u.kg/u.m**3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Temperature</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">temp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;density_water received both Temperature and temp&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Temperature</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;density_water missing Temperature argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;temp is deprecated; use Temperature instead.&quot;</span><span class="p">,</span>
                      <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">Temperature</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Temperature</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature in Kelvin&quot;</span><span class="p">])</span>
    <span class="n">rhointerpolated</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">CubicSpline</span><span class="p">(</span><span class="n">WATER_DENSITY_TABLE</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                              <span class="n">WATER_DENSITY_TABLE</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">Temperature</span> <span class="o">=</span> <span class="n">Temperature</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">degK</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>
    <span class="k">return</span> <span class="n">rhointerpolated</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span></div>


<div class="viewcode-block" id="viscosity_kinematic"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.viscosity_kinematic">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">viscosity_kinematic</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `viscosity_kinematic` is deprecated; use `viscosity_kinematic_water`</span>
<span class="sd">        instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;viscosity_kinematic is deprecated; use &#39;</span>
                  <span class="s1">&#39;viscosity_kinematic_water instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">viscosity_kinematic_water</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></div>


<div class="viewcode-block" id="viscosity_kinematic_water"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.viscosity_kinematic_water">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">viscosity_kinematic_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the kinematic viscosity of water at a given temperature.</span>

<span class="sd">    :param Temperature: temperature of water</span>
<span class="sd">    :type Temperature: u.degK</span>

<span class="sd">    :return: kinematic viscosity of water</span>
<span class="sd">    :rtype: u.m**2/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Temperature</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature in Kelvin&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">viscosity_dynamic_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span> <span class="o">/</span> <span class="n">density_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">))</span></div>

<span class="c1">####################### Hydraulic Radius #######################</span>


<div class="viewcode-block" id="radius_hydraulic"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.radius_hydraulic">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">radius_hydraulic</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">openchannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `radius_hydraulic` is deprecated; use `radius_hydraulic_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;radius_hydraulic is deprecated; use radius_hydraulic_rect &#39;</span>
                  <span class="s1">&#39;instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">openchannel</span><span class="p">)</span></div>


<div class="viewcode-block" id="radius_hydraulic_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.radius_hydraulic_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">radius_hydraulic_rect</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the hydraulic radius of a rectangular channel given width and</span>
<span class="sd">    depth of water.</span>

<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param OpenChannel: true if channel is open, false if closed</span>
<span class="sd">    :type OpenChannel: boolean</span>

<span class="sd">    :return: hydraulic radius of rectangular channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Width</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Depth</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Depth&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">OpenChannel</span><span class="p">,</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span> <span class="s2">&quot;OpenChannel&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">OpenChannel</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">Width</span><span class="o">*</span><span class="n">Depth</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Width</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Depth</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">Width</span><span class="o">*</span><span class="n">Depth</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Width</span><span class="o">+</span><span class="n">Depth</span><span class="p">)))</span></div>


<div class="viewcode-block" id="radius_hydraulic_general"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.radius_hydraulic_general">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">radius_hydraulic_general</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `radius_hydraulic_general` is deprecated; use</span>
<span class="sd">        `radius_hydraulic_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;radius_hydraulic_general is deprecated; use &#39;</span>
                  <span class="s1">&#39;radius_hydraulic_channel instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">radius_hydraulic_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">)</span></div>


<div class="viewcode-block" id="radius_hydraulic_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.radius_hydraulic_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">radius_hydraulic_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the hydraulic radius of a general channel given cross sectional</span>
<span class="sd">    area and wetted perimeter.</span>

<span class="sd">    :param Area: cross sectional area of channel</span>
<span class="sd">    :type Area: u.m**2</span>
<span class="sd">    :param PerimWetted: wetted perimeter of channel</span>
<span class="sd">    :type PerimWetted: u.m</span>

<span class="sd">    :return: hydraulic radius of general channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Area</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Area&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">PerimWetted</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Wetted perimeter&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Area</span> <span class="o">/</span> <span class="n">PerimWetted</span><span class="p">)</span></div>

<span class="c1">####################### Reynolds Number #######################</span>


<div class="viewcode-block" id="re_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.re_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">re_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the Reynolds number of flow through a pipe.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>

<span class="sd">    :return: Reynolds number of flow through pipe</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">4</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Diam</span> <span class="o">*</span> <span class="n">Nu</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>


<div class="viewcode-block" id="re_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.re_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">re_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">openchannel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the Reynolds number of flow through a rectangular channel.</span>

<span class="sd">    :param FlowRate: flow rate through channel</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param OpenChannel: true if channel is open, false if closed</span>
<span class="sd">    :type OpenChannel: boolean</span>

<span class="sd">    :param openchannel: deprecated; use OpenChannel instead</span>

<span class="sd">    :return: Reynolds number of flow through rectangular channel</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;re_rect received both OpenChannel and openchannel&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;re_rect missing OpenChannel argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;openchannel is deprecated; use OpenChannel instead.&quot;</span><span class="p">,</span>
                      <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">OpenChannel</span> <span class="o">=</span> <span class="n">openchannel</span>

    <span class="k">return</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">FlowRate</span> <span class="o">*</span> <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">Width</span> <span class="o">*</span> <span class="n">Depth</span> <span class="o">*</span> <span class="n">Nu</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>


<div class="viewcode-block" id="re_general"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.re_general">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">re_general</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `re_general` is deprecated; use `re_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;re_general is deprecated; use re_channel instead.&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span></div>


<div class="viewcode-block" id="re_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.re_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">re_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the Reynolds number of flow through a general cross section.</span>

<span class="sd">    :param Vel: velocity of fluid</span>
<span class="sd">    :type Vel: u.m/u.s</span>
<span class="sd">    :param Area: cross sectional area of channel</span>
<span class="sd">    :type Area: u.m**2</span>
<span class="sd">    :param PerimWetted: wetted perimeter of channel</span>
<span class="sd">    :type PerimWetted: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>

<span class="sd">    :return: Reynolds number of flow through general cross section</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Vel</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Velocity&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">radius_hydraulic_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">)</span> <span class="o">*</span> <span class="n">Vel</span> <span class="o">/</span> <span class="n">Nu</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>

<span class="c1">########################### Friction ###########################</span>


<div class="viewcode-block" id="fric"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `fric` is deprecated; use `fric_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;fric is deprecated; use fric_pipe instead&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fric_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="fric_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the friction factor for pipe flow.</span>

<span class="sd">    For laminar flow, the friction factor is 64 is divided the Reynolds number.</span>
<span class="sd">    For turbulent flows, friction factor is calculated using the Swamee-Jain</span>
<span class="sd">    equation, which works best for Re &gt; 3000 and ε/Diam &lt; 0.02.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: friction factor of flow through pipe</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Roughness</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipe roughness&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">re_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">RE_TRANSITION_PIPE</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Roughness</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.7</span> <span class="o">*</span> <span class="n">Diam</span><span class="p">)</span>
                              <span class="o">+</span> <span class="mf">5.74</span> <span class="o">/</span> <span class="n">re_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.9</span>
                              <span class="p">)</span>
                     <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
             <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">/</span> <span class="n">re_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span></div>


<div class="viewcode-block" id="fric_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
              <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">openchannel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the friction factor of a rectangular channel.</span>

<span class="sd">    The Swamee-Jain equation is adapted for a rectangular channel.</span>

<span class="sd">    :param FlowRate: flow rate through channel</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of channel</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param OpenChannel: true if channel is open, false if closed</span>
<span class="sd">    :type OpenChannel: boolean</span>

<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>
<span class="sd">    :param openchannel: deprecated; use OpenChannel instead</span>

<span class="sd">    :return: friction factor of flow through rectangular channel</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fric_rect received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fric_rect missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fric_rect received both OpenChannel and openchannel&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;fric_rect missing OpenChannel argument&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>
        <span class="k">if</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;openchannel is deprecated; use OpenChannel instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">OpenChannel</span> <span class="o">=</span> <span class="n">openchannel</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Roughness</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipe roughness&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">re_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">RE_TRANSITION_PIPE</span><span class="p">:</span>
        <span class="c1"># Diam = 4*R_h in adapted Swamee-Jain equation</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">Roughness</span>
                             <span class="o">/</span> <span class="p">(</span><span class="mf">3.7</span> <span class="o">*</span> <span class="mi">4</span>
                                <span class="o">*</span> <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span>
                                                        <span class="n">OpenChannel</span><span class="p">)</span>
                                <span class="p">)</span>
                             <span class="p">)</span>
                            <span class="o">+</span> <span class="p">(</span><span class="mf">5.74</span> <span class="o">/</span> <span class="p">(</span><span class="n">re_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span>
                                               <span class="n">Nu</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.9</span><span class="p">)</span>
                               <span class="p">)</span>
                            <span class="p">)</span>
                   <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span> <span class="o">/</span> <span class="n">re_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span>
                                              <span class="n">OpenChannel</span><span class="p">)</span></div>


<div class="viewcode-block" id="fric_general"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric_general">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric_general</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `fric_general` is deprecated; use `fric_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;fric_general is deprecated; use fric_channel instead.&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fric_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="fric_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the friction factor for a general channel.</span>

<span class="sd">    The Swamee-Jain equation is adapted for a general cross-section.</span>

<span class="sd">    :param Area: cross sectional area of channel</span>
<span class="sd">    :type Area: u.m**2</span>
<span class="sd">    :param PerimWetted: wetted perimeter of channel</span>
<span class="sd">    :type PerimWetted: u.m</span>
<span class="sd">    :param Vel: velocity of fluid</span>
<span class="sd">    :type Vel: u.m/u.s</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param PipeRough: roughness of channel</span>
<span class="sd">    :type PipeRough: u.m</span>

<span class="sd">    :return: friction factor for flow through general channel</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Roughness</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipe roughness&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">re_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">RE_TRANSITION_PIPE</span><span class="p">:</span>
        <span class="c1"># Diam = 4*R_h in adapted Swamee-Jain equation</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">/</span>
             <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">Roughness</span>
                        <span class="o">/</span> <span class="p">(</span><span class="mf">3.7</span> <span class="o">*</span> <span class="mi">4</span>
                           <span class="o">*</span> <span class="n">radius_hydraulic_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">)</span>
                           <span class="p">)</span>
                        <span class="p">)</span>
                       <span class="o">+</span> <span class="p">(</span><span class="mf">5.74</span>
                          <span class="o">/</span> <span class="n">re_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.9</span>
                          <span class="p">)</span>
                       <span class="p">)</span>
              <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
             <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">/</span> <span class="n">re_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span></div>

<span class="c1">######################### Head Loss #########################</span>


<div class="viewcode-block" id="headloss_fric"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_fric">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_fric</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_fric` is deprecated; use `headloss_major_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_fric is deprecated; use headloss_major_pipe instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_major_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_major_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the major head loss (due to wall shear) in a pipe.</span>

<span class="sd">    This function applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: major head loss in pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fric_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span>
            <span class="o">*</span> <span class="mi">8</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">Length</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Diam</span><span class="o">**</span><span class="mi">5</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_exp"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_exp">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_exp</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_exp` is deprecated; use `headloss_minor_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_exp is deprecated; use headloss_minor_pipe instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_minor_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_minor_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the minor head loss (due to changes in geometry) in a pipe.</span>

<span class="sd">    This function applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: minor head loss in pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">KMinor</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;K minor&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">KMinor</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">Diam</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss` is deprecated; use `headloss_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss is deprecated; use headloss_pipe instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the total head loss from major and minor losses in a pipe.</span>

<span class="sd">    This function applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: total head loss in pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">headloss_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">))</span></div>


<div class="viewcode-block" id="headloss_fric_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_fric_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_fric_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">,</span> <span class="n">openchannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_fric_rect` is deprecated; use `headloss_major_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_fric_rect is deprecated; use headloss_major_rect instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_major_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">,</span> <span class="n">openchannel</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_major_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_major_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_major_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the major head loss due to wall shear in a rectangular channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through channel</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param Length: length of channel</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of channel</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param OpenChannel: true if channel is open, false if closed</span>
<span class="sd">    :type OpenChannel: boolean</span>

<span class="sd">    :return: major head loss in rectangular channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fric_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span>
                      <span class="n">Roughness</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">Length</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="n">Depth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_exp_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_exp_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_exp_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_exp_rect` is deprecated; use `headloss_minor_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_exp_rect is deprecated; use headloss_minor_rect instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_minor_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_minor_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_minor_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_minor_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the minor head loss due to expansion in a rectangular channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through channel</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: minor head loss in rectangular channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Width</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Depth</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Depth&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">KMinor</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;K minor&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">KMinor</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="n">Depth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">OpenChannel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">openchannel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the total head loss from major and minor losses in a rectangular</span>
<span class="sd">    channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param FlowRate: flow rate through channel</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel</span>
<span class="sd">    :type Width: u.m</span>
<span class="sd">    :param Depth: depth of water in channel</span>
<span class="sd">    :type Depth: u.m</span>
<span class="sd">    :param Length: length of channel</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of channel</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param OpenChannel: true if channel is open, false if closed</span>
<span class="sd">    :type OpenChannel: boolean</span>

<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>
<span class="sd">    :type openchannel: deprecated; use OpenChannel instead</span>

<span class="sd">    :return: total head loss in rectangular channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_rect received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_rect missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_rect received both OpenChannel and openchannel&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">OpenChannel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_rect missing OpenChannel argument&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>
        <span class="k">if</span> <span class="n">openchannel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;openchannel is deprecated; use OpenChannel instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">OpenChannel</span> <span class="o">=</span> <span class="n">openchannel</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">headloss_minor_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">headloss_major_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Depth</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                  <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">OpenChannel</span><span class="p">))</span></div>


<div class="viewcode-block" id="headloss_fric_general"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_fric_general">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_fric_general</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_fric_general` is deprecated; use `headloss_major_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_fric_general` is deprecated; use `headloss_major_channel` instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_major_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_major_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_major_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_major_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the major head loss due to wall shear in a general channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param Area: cross sectional area of channel</span>
<span class="sd">    :type Area: u.m**2</span>
<span class="sd">    :param PerimWetted: wetted perimeter of channel</span>
<span class="sd">    :type PerimWetted: u.m</span>
<span class="sd">    :param Vel: velocity of fluid</span>
<span class="sd">    :type Vel: u.m/u.s</span>
<span class="sd">    :param Length: length of channel</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of channel</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: major head loss in general channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fric_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span> <span class="o">*</span> <span class="n">Length</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">radius_hydraulic_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">Vel</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_exp_general"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_exp_general">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_exp_general</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_exp_general` is deprecated; use `headloss_minor_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_exp_general` is deprecated; use `headloss_minor_channel` instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_minor_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_minor_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_minor_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_minor_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the minor head loss due to expansion in a general channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param Vel: velocity of fluid</span>
<span class="sd">    :type Vel: u.m/u.s</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: minor head loss in general channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Vel</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Velocity&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">KMinor</span><span class="p">,</span> <span class="s1">&#39;&gt;=0&#39;</span><span class="p">,</span> <span class="s1">&#39;K minor&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">KMinor</span> <span class="o">*</span> <span class="n">Vel</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_gen"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_gen">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_gen</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_gen` is deprecated; use `headloss_channel` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_gen` is deprecated; use `headloss_channel` instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_channel"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_channel">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the total head loss from major and minor losses in a general</span>
<span class="sd">    channel.</span>

<span class="sd">    This equation applies to both laminar and turbulent flows.</span>

<span class="sd">    :param Area: cross sectional area of channel</span>
<span class="sd">    :type Area: u.m**2</span>
<span class="sd">    :param Vel: velocity of fluid</span>
<span class="sd">    :type Vel: u.m/u.s</span>
<span class="sd">    :param PerimWetted: wetted perimeter of channel</span>
<span class="sd">    :type PerimWetted: u.m</span>
<span class="sd">    :param Length: length of channel</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of channel</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: total head loss in general channel</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">headloss_minor_channel</span><span class="p">(</span><span class="n">Vel</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">headloss_major_channel</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">PerimWetted</span><span class="p">,</span> <span class="n">Vel</span><span class="p">,</span>
                                     <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_manifold"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_manifold">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_manifold</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NumOutlets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the total head loss through the manifold.</span>

<span class="sd">    :param FlowRate: flow rate through manifold</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of manifold</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Length: length of manifold</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of manifold</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param NumOutlets: number of outlets from manifold</span>
<span class="sd">    :type NumOutlets: u.dimensionless or unitless</span>

<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>

<span class="sd">    :return: total headloss through manifold</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">NumOutlets</span><span class="p">,</span> <span class="s2">&quot;&gt;0, int&quot;</span><span class="p">,</span> <span class="s1">&#39;Number of outlets&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_manifold received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_manifold missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">NumOutlets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;headloss_manifold missing NumOutlets argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                      <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">headloss_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
               <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">NumOutlets</span><span class="p">))</span>
               <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">NumOutlets</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
               <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="elbow_minor_loss"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.elbow_minor_loss">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">elbow_minor_loss</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">id_</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `elbow_minor_loss` is deprecated; use `headloss_minor_elbow` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;elbow_minor_loss is deprecated; use headloss_minor_elbow instead&#39;</span><span class="p">,</span>
                  <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_minor_elbow</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">id_</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_minor_elbow"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_minor_elbow">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_minor_elbow</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the minor head loss (due to changes in geometry) in an elbow.</span>

<span class="sd">    :param FlowRate: flow rate through pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: minor head loss in pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vel</span> <span class="o">=</span> <span class="n">FlowRate</span> <span class="o">/</span> <span class="n">area_circle</span><span class="p">(</span><span class="n">Diam</span><span class="p">)</span>
    <span class="n">minor_loss</span> <span class="o">=</span> <span class="n">KMinor</span> <span class="o">*</span> <span class="n">vel</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">minor_loss</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>

<span class="c1">######################### Orifices #########################</span>


<div class="viewcode-block" id="flow_orifice"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_orifice">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_orifice</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate of the orifice.</span>

<span class="sd">    :param Diam: diameter of orifice</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Height: piezometric height of orifice</span>
<span class="sd">    :type Height: u.m</span>
<span class="sd">    :param RatioVCOrifice: vena contracta ratio of orifice</span>
<span class="sd">    :type RatioVCOrifice: u.dimensionless or unitless</span>

<span class="sd">    :return: flow rate of orifice</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="s2">&quot;0-1&quot;</span><span class="p">,</span> <span class="s2">&quot;VC orifice ratio&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">Height</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">RatioVCOrifice</span> <span class="o">*</span> <span class="n">area_circle</span><span class="p">(</span><span class="n">Diam</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">Height</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span></div>


<div class="viewcode-block" id="flow_orifice_vert"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_orifice_vert">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_orifice_vert</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the vertical flow rate of the orifice.</span>

<span class="sd">    :param Diam: diameter of orifice</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Height: piezometric height of orifice</span>
<span class="sd">    :type Height: u.m</span>
<span class="sd">    :param RatioVCOrifice: vena contracta ratio of orifice</span>
<span class="sd">    :type RatioVCOrifice: u.dimensionless or unitless</span>

<span class="sd">    :return: vertical flow rate of orifice</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="s2">&quot;0-1&quot;</span><span class="p">,</span> <span class="s2">&quot;VC orifice ratio&quot;</span><span class="p">])</span>
    <span class="n">Diam</span> <span class="o">=</span> <span class="n">Diam</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
    <span class="n">Height</span> <span class="o">=</span> <span class="n">Height</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Height</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">Diam</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">flow_vert</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="n">Diam</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">Diam</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
                                              <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Height</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
                                              <span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span>
                                   <span class="o">-</span> <span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                                   <span class="nb">min</span><span class="p">(</span><span class="n">Diam</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">flow_vert</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">RatioVCOrifice</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span></div>


<div class="viewcode-block" id="head_orifice"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.head_orifice">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">head_orifice</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the piezometric head of the orifice.</span>

<span class="sd">    :param Diam: diameter of orifice</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param RatioVCOrifice: vena contracta ratio of orifice</span>
<span class="sd">    :type RatioVCOrifice: u.dimensionless or unitless</span>
<span class="sd">    :param FlowRate: flow rate of orifice</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>

<span class="sd">    :return: head of orifice</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="s2">&quot;0-1&quot;</span><span class="p">,</span> <span class="s2">&quot;VC orifice ratio&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">FlowRate</span>
             <span class="o">/</span> <span class="p">(</span><span class="n">RatioVCOrifice</span> <span class="o">*</span> <span class="n">area_circle</span><span class="p">(</span><span class="n">Diam</span><span class="p">))</span>
             <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="area_orifice"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.area_orifice">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">area_orifice</span><span class="p">(</span><span class="n">Height</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the area of the orifice.</span>

<span class="sd">    :param Height: piezometric height of orifice</span>
<span class="sd">    :type Height: u.m</span>
<span class="sd">    :param RatioVCOrifice: vena contracta ratio of orifice</span>
<span class="sd">    :type RatioVCOrifice: u.dimensionless or unitless</span>
<span class="sd">    :param FlowRate: flow rate of orifice</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>

<span class="sd">    :return: area of orifice</span>
<span class="sd">    :rtype: u.m**2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Height</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Height&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="s2">&quot;0-1, &gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;VC orifice ratio&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">FlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">RatioVCOrifice</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span>
                                                 <span class="n">Height</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="num_orifices"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.num_orifices">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">num_orifices</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="n">HeadLossOrifice</span><span class="p">,</span> <span class="n">DiamOrifice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the number of orifices.</span>

<span class="sd">    :param FlowRate: flow rate of orifice</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param RatioVCOrifice: vena contracta ratio of orifice</span>
<span class="sd">    :type RatioVCOrifice: u.dimensionless or unitless</span>
<span class="sd">    :param HeadLossOrifice: head loss of orifice</span>
<span class="sd">    :type HeadLossOrifice: u.m</span>
<span class="sd">    :param DiamOrifice: diameter of orifice</span>
<span class="sd">    :type DiamOrifice: u.m</span>

<span class="sd">    :return: number of orifices</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">area_orifice</span><span class="p">(</span><span class="n">HeadLossOrifice</span><span class="p">,</span> <span class="n">RatioVCOrifice</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">)</span>
                   <span class="o">/</span> <span class="n">area_circle</span><span class="p">(</span><span class="n">DiamOrifice</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>

<span class="c1">########################### Flows ###########################</span>


<div class="viewcode-block" id="flow_transition"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_transition">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_transition</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate for the laminar/turbulent transition.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>

<span class="sd">    :return: flow rate for laminar/turbulent transition</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">Diam</span> <span class="o">*</span> <span class="n">RE_TRANSITION_PIPE</span> <span class="o">*</span> <span class="n">Nu</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_hagen"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_hagen">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_hagen</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate for laminar flow with only major losses.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param HeadLossMajor: head loss due to friction</span>
<span class="sd">    :type HeadLossMajor: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>

<span class="sd">    :param HeadLossFric: deprecated; use HeadLossMajor instead</span>

<span class="sd">    :return: flow rate for laminar flow with only major losses</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_hagen received both HeadLossMajor and HeadLossFric&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_hagen missing HeadLossMajor argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_hagen missing Length argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Nu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_hagen missing Nu argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;HeadLossFric is deprecated; use HeadLossMajor instead.&quot;</span><span class="p">,</span>
                      <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">HeadLossMajor</span> <span class="o">=</span> <span class="n">HeadLossFric</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">HeadLossMajor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Headloss due to friction&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Diam</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">128</span><span class="o">*</span><span class="n">Nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMajor</span>
            <span class="o">/</span> <span class="n">Length</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_swamee"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_swamee">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_swamee</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate for turbulent flow with only major losses.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param HeadLossMajor: head loss due to friction</span>
<span class="sd">    :type HeadLossMajor: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :param HeadLossFric: deprecated; use HeadLossMajor instead</span>
<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>

<span class="sd">    :return: flow rate for turbulent flow with only major losses</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee received both HeadLossMajor and HeadLossFric&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee missing HeadLossMajor argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee missing Length argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Nu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee missing Nu argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_swamee missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;HeadLossFric is deprecated; use HeadLossMajor instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">HeadLossMajor</span> <span class="o">=</span> <span class="n">HeadLossFric</span>
        <span class="k">if</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Diam</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Diameter&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">HeadLossMajor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Headloss due to friction&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Roughness</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipe roughness&quot;</span><span class="p">])</span>
    <span class="n">logterm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Roughness</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.7</span> <span class="o">*</span> <span class="n">Diam</span><span class="p">)</span>
                       <span class="o">+</span> <span class="mf">2.51</span> <span class="o">*</span> <span class="n">Nu</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Length</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span>
                                                       <span class="o">*</span> <span class="n">HeadLossMajor</span>
                                                       <span class="o">*</span> <span class="n">Diam</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                                             <span class="p">)</span>
                       <span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">Diam</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">logterm</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMajor</span> <span class="o">/</span> <span class="n">Length</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_pipemajor"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_pipemajor">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_pipemajor</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `flow_pipemajor` is deprecated; use `flow_major_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;flow_pipemajor is deprecated; use &#39;</span>
                  <span class="s1">&#39;flow_major_pipe instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flow_major_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_major_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_major_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_major_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate with only major losses.</span>

<span class="sd">    This function applies to both laminar and turbulent flows.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param HeadLossMajor: head loss due to friction</span>
<span class="sd">    :type HeadLossMajor: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: flow rate with only major losses</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">FlowHagen</span> <span class="o">=</span> <span class="n">flow_hagen</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">FlowHagen</span> <span class="o">&lt;</span> <span class="n">flow_transition</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">Nu</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FlowHagen</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">flow_swamee</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_pipeminor"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_pipeminor">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_pipeminor</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossExpans</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `flow_pipeminor` is deprecated; use `flow_minor_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;flow_pipeminor is deprecated; use &#39;</span>
                  <span class="s1">&#39;flow_minor_pipe instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flow_minor_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossExpans</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_minor_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_minor_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_minor_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLossMinor</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate with only minor losses.</span>

<span class="sd">    This function applies to both laminar and turbulent flows.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param HeadLossExpans: head loss due to expansion</span>
<span class="sd">    :type HeadLossExpans: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: flow rate with only minor losses</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">HeadLossMinor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Headloss due to expansion&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">KMinor</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;K minor&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">area_circle</span><span class="p">(</span><span class="n">Diam</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMinor</span>
                                        <span class="o">/</span> <span class="n">KMinor</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">KMinor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate in a pipe.</span>

<span class="sd">    This function works for both major and minor losses as well as</span>
<span class="sd">    both laminar and turbulent flows.</span>

<span class="sd">    :param Diam: diameter of pipe</span>
<span class="sd">    :type Diam: u.m</span>
<span class="sd">    :param HeadLoss: total head loss from major and minor losses</span>
<span class="sd">    :type HeadLoss: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>

<span class="sd">    :return: flow rate in pipe</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_pipe received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_pipe missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">KMinor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;flow_pipe missing KMinor argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>

    <span class="k">if</span> <span class="n">KMinor</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">FlowRate</span> <span class="o">=</span> <span class="n">flow_major_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span>
                                   <span class="n">Roughness</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">FlowRatePrev</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">err</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">FlowRate</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">flow_major_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                       <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">),</span>
                       <span class="n">flow_minor_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span>
                       <span class="p">)</span>
        <span class="k">while</span> <span class="n">err</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="n">FlowRatePrev</span> <span class="o">=</span> <span class="n">FlowRate</span>
            <span class="n">HLFricNew</span> <span class="o">=</span> <span class="p">(</span><span class="n">HeadLoss</span> <span class="o">*</span> <span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                                        <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span>
                         <span class="o">/</span> <span class="p">(</span><span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                                <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span>
                            <span class="o">+</span> <span class="n">headloss_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span>
                            <span class="p">)</span>
                         <span class="p">)</span>
            <span class="n">FlowRate</span> <span class="o">=</span> <span class="n">flow_major_pipe</span><span class="p">(</span><span class="n">Diam</span><span class="p">,</span> <span class="n">HLFricNew</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                       <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">FlowRate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">FlowRate</span> <span class="o">-</span> <span class="n">FlowRatePrev</span><span class="p">)</span>
                       <span class="o">/</span> <span class="p">((</span><span class="n">FlowRate</span> <span class="o">+</span> <span class="n">FlowRatePrev</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                       <span class="p">)</span>
    <span class="k">return</span> <span class="n">FlowRate</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>

<span class="c1">########################## Diameters ##########################</span>


<div class="viewcode-block" id="diam_hagen"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_hagen">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_hagen</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the inner diameter of a pipe with laminar flow and no minor losses.</span>

<span class="sd">    The Hagen Poiseuille equation is dimensionally correct and returns the</span>
<span class="sd">    inner diameter of a pipe given the flow rate and the head loss due</span>
<span class="sd">    to shear on the pipe walls. The Hagen Poiseuille equation does NOT take</span>
<span class="sd">    minor losses into account. This equation ONLY applies to laminar flow.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param HeadLossFric: head loss due to friction</span>
<span class="sd">    :type HeadLossFric: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>

<span class="sd">    :param HeadLossFric: deprecated; use HeadLossMajor instead</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_hagen received both HeadLossMajor and HeadLossFric&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_hagen missing HeadLossMajor argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_hagen missing Length argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Nu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_hagen missing Nu argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;HeadLossFric is deprecated; use HeadLossMajor instead.&quot;</span><span class="p">,</span>
                      <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">HeadLossMajor</span> <span class="o">=</span> <span class="n">HeadLossFric</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">HeadLossMajor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Headloss due to friction&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(((</span><span class="mi">128</span> <span class="o">*</span> <span class="n">Nu</span> <span class="o">*</span> <span class="n">FlowRate</span> <span class="o">*</span> <span class="n">Length</span><span class="p">)</span>
             <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMajor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
             <span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_swamee"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_swamee">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_swamee</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Roughness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PipeRough</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the inner diameter of a pipe with turbulent flow and no minor losses.</span>

<span class="sd">    The Swamee Jain equation is dimensionally correct and returns the</span>
<span class="sd">    inner diameter of a pipe given the flow rate and the head loss due</span>
<span class="sd">    to shear on the pipe walls. The Swamee Jain equation does NOT take</span>
<span class="sd">    minor losses into account. This equation ONLY applies to turbulent</span>
<span class="sd">    flow.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param HeadLossFric: head loss due to friction</span>
<span class="sd">    :type HeadLossFric: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param PipeRough: roughness of pipe</span>
<span class="sd">    :type PipeRough: u.m</span>

<span class="sd">    :param HeadLossFric: deprecated; use HeadLossMajor instead</span>
<span class="sd">    :param PipeRough: deprecated; use Roughness instead</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee received both HeadLossMajor and HeadLossFric&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">HeadLossMajor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee missing HeadLossMajor argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee missing Length argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Nu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee missing Nu argument&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee received both Roughness and PipeRough&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Roughness</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;diam_swamee missing Roughness argument&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">HeadLossFric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;HeadLossFric is deprecated; use HeadLossMajor instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">HeadLossMajor</span> <span class="o">=</span> <span class="n">HeadLossFric</span>
        <span class="k">if</span> <span class="n">PipeRough</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;PipeRough is deprecated; use Roughness instead.&quot;</span><span class="p">,</span>
                          <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">Roughness</span> <span class="o">=</span> <span class="n">PipeRough</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Length</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Length&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">HeadLossMajor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Headloss due to friction&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Nu</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Nu&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Roughness</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipe roughness&quot;</span><span class="p">])</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="n">Roughness</span> <span class="o">**</span> <span class="mf">1.25</span><span class="p">)</span>
         <span class="o">*</span> <span class="p">((</span><span class="n">Length</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMajor</span><span class="p">)</span>
            <span class="p">)</span><span class="o">**</span><span class="mf">4.75</span>
         <span class="p">)</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">Nu</span><span class="o">**</span><span class="mi">5</span> <span class="o">*</span> <span class="n">FlowRate</span><span class="o">**</span><span class="mi">47</span>
         <span class="o">*</span> <span class="p">(</span><span class="n">Length</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMajor</span><span class="p">))</span> <span class="o">**</span> <span class="mi">26</span>
         <span class="p">)</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="o">**</span><span class="mf">0.2</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">0.66</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mf">0.04</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_pipemajor"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_pipemajor">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_pipemajor</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `diam_pipemajor` is deprecated; use `diam_major_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;diam_pipemajor is deprecated; use &#39;</span>
                  <span class="s1">&#39;diam_major_pipe instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diam_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossFric</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_major_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_major_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the pipe inner diameter that would result in given major losses.</span>

<span class="sd">    This function applies to both laminar and turbulent flow.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param HeadLossMajor: head loss due to friction</span>
<span class="sd">    :type HeadLossMajor: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param Roughness: roughness of pipe</span>
<span class="sd">    :type Roughness: u.m</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DiamLaminar</span> <span class="o">=</span> <span class="n">diam_hagen</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">re_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">DiamLaminar</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">RE_TRANSITION_PIPE</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DiamLaminar</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">diam_swamee</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMajor</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                           <span class="n">Nu</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_pipeminor"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_pipeminor">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_pipeminor</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossExpans</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `diam_pipeminor` is deprecated; use `diam_minor_pipe` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;diam_pipeminor is deprecated; use &#39;</span>
                  <span class="s1">&#39;diam_minor_pipe instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diam_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossExpans</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_minor_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_minor_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLossMinor</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the pipe inner diameter that would result in the given minor losses.</span>

<span class="sd">    This function applies to both laminar and turbulent flow.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param HeadLossMinor: head loss due to expansion</span>
<span class="sd">    :type HeadLossMinor: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">KMinor</span><span class="p">,</span> <span class="s2">&quot;&gt;=0&quot;</span><span class="p">,</span> <span class="s2">&quot;K minor&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">HeadLossMinor</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Headloss due to expansion&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">FlowRate</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">KMinor</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeadLossMinor</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="diam_pipe"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.diam_pipe">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">diam_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the pipe inner diameter that would result in the given total head</span>
<span class="sd">    loss.</span>

<span class="sd">    This function applies to both laminar and turbulent flow and</span>
<span class="sd">    incorporates both minor and major losses.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param HeadLoss: total head loss from major and minor losses</span>
<span class="sd">    :type HeadLoss: u.m</span>
<span class="sd">    :param Length: length of pipe</span>
<span class="sd">    :type Length: u.m</span>
<span class="sd">    :param Nu: kinematic viscosity of fluid</span>
<span class="sd">    :type Nu: u.m**2/u.s</span>
<span class="sd">    :param PipeRough: roughness of pipe</span>
<span class="sd">    :type PipeRough: u.m</span>
<span class="sd">    :param KMinor: minor loss coefficient</span>
<span class="sd">    :type KMinor: u.dimensionless or unitless</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">KMinor</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Diam</span> <span class="o">=</span> <span class="n">diam_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span>
                               <span class="n">PipeRough</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Diam</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">diam_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span>
                                   <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span><span class="p">),</span>
                   <span class="n">diam_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HeadLoss</span><span class="p">,</span> <span class="n">KMinor</span><span class="p">))</span>
        <span class="n">err</span> <span class="o">=</span> <span class="mf">1.00</span>
        <span class="k">while</span> <span class="n">err</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">DiamPrev</span> <span class="o">=</span> <span class="n">Diam</span>
            <span class="n">HLFricNew</span> <span class="o">=</span> <span class="p">(</span><span class="n">HeadLoss</span> <span class="o">*</span> <span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                                        <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span>
                                                        <span class="p">)</span>
                         <span class="o">/</span> <span class="p">(</span><span class="n">headloss_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span>
                                                <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span>
                                                <span class="p">)</span>
                            <span class="o">+</span> <span class="n">headloss_minor_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Diam</span><span class="p">,</span> <span class="n">KMinor</span>
                                                  <span class="p">)</span>
                            <span class="p">)</span>
                         <span class="p">)</span>
            <span class="n">Diam</span> <span class="o">=</span> <span class="n">diam_major_pipe</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">HLFricNew</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">PipeRough</span>
                                   <span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Diam</span> <span class="o">-</span> <span class="n">DiamPrev</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">Diam</span> <span class="o">+</span> <span class="n">DiamPrev</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Diam</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="pipe_ID"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.pipe_ID">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">pipe_ID</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Pressure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the inner diameter of a pipe for a given pressure</span>
<span class="sd">    recovery constraint.</span>

<span class="sd">    :param FlowRate: flow rate of pipe</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Pressure: pressure recovery constraint</span>
<span class="sd">    :type Pressure: u.m</span>

<span class="sd">    :return: inner diameter of pipe</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Pressure</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Pressure&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">FlowRate</span><span class="o">/</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="o">*</span><span class="n">Pressure</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>

<span class="c1">############################ Weirs ############################</span>


<div class="viewcode-block" id="width_rect_weir"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.width_rect_weir">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">width_rect_weir</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Height</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `width_rect_weir` is deprecated; use `width_weir_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;width_rect_weir is deprecated; use &#39;</span>
                  <span class="s1">&#39;width_weir_rect instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">width_weir_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span></div>


<div class="viewcode-block" id="width_weir_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.width_weir_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">width_weir_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Height</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the width of a rectangular weir given its flow rate and the</span>
<span class="sd">    height of the water above the weir. For a weir that is a vertical pipe,</span>
<span class="sd">    this value is the circumference.</span>

<span class="sd">    :param FlowRate: flow rate over weir</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Height: height of water above weir</span>
<span class="sd">    :type Height: u.m</span>

<span class="sd">    :return: width of weir</span>
<span class="sd">    :rtypes: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Height</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Height&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">FlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">VC_ORIFICE_RATIO</span>
                                  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span> <span class="o">*</span> <span class="n">Height</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_weir"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_weir">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_weir</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_weir` is deprecated; use `headloss_weir_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;headloss_weir is deprecated; use &#39;</span>
                  <span class="s1">&#39;headloss_weir_rect instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headloss_weir_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_weir_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_weir_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_weir_rect</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the head loss of a rectangular or vertical pipe weir.</span>

<span class="sd">    Head loss for a weir is the difference in height between the water</span>
<span class="sd">    upstream of the weir and the top of the weir.</span>

<span class="sd">    :param FlowRate: flow rate over weir</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of weir (circumference for a vertical pipe)</span>
<span class="sd">    :type Width: u.m</span>

<span class="sd">    :return: head loss of weir</span>
<span class="sd">    :rtypes: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Width</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((((</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">FlowRate</span>
              <span class="o">/</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">VC_ORIFICE_RATIO</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span> <span class="o">*</span> <span class="n">Width</span><span class="p">)</span>
              <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_rect_weir"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_rect_weir">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_rect_weir</span><span class="p">(</span><span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `flow_rect_weir` is deprecated; use `flow_weir_rect` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;flow_rect_weir is deprecated; use &#39;</span>
                  <span class="s1">&#39;flow_weir_rect instead.&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flow_weir_rect</span><span class="p">(</span><span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">)</span></div>


<div class="viewcode-block" id="flow_weir_rect"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.flow_weir_rect">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">flow_weir_rect</span><span class="p">(</span><span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the flow rate of a rectangular or vertical pipe weir.</span>

<span class="sd">    :param Height: height of water above weir</span>
<span class="sd">    :type Height: u.m</span>
<span class="sd">    :param Width: width of weir (circumference for a vertical pipe)</span>
<span class="sd">    :type Width: u.m</span>

<span class="sd">    :return: flow of weir</span>
<span class="sd">    :rtype: u.m**3/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">Height</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Height&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Width</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">VC_ORIFICE_RATIO</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span> <span class="o">*</span> <span class="n">Height</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">Width</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>

<span class="c1">######################## Porous Media ########################</span>

<div class="viewcode-block" id="DeprecatedFunctionError"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.DeprecatedFunctionError">[docs]</a><span class="k">class</span> <span class="nc">DeprecatedFunctionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span></div>

<div class="viewcode-block" id="headloss_kozeny"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_kozeny">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_kozeny</span><span class="p">(</span><span class="n">Length</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ApproachVel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Porosity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">Diam</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Vel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated::</span>
<span class="sd">        `headloss_kozeny` is deprecated; use `headloss_ergun` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="n">DeprecatedFunctionError</span><span class="p">(</span><span class="s2">&quot;This function is deprecated. Please use headloss_ergun.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="re_ergun"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.re_ergun">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">re_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the Reynolds number for flow through porous media.</span>

<span class="sd">    :param ApproachVel: approach velocity or superficial fluid velocity</span>
<span class="sd">    :type ApproachVel: u.m/u.s</span>
<span class="sd">    :param DiamMedia: particle diameter</span>
<span class="sd">    :type DiamMedia: u.m</span>
<span class="sd">    :param Temperature: temperature of porous medium</span>
<span class="sd">    :type Temperature: u.degK</span>
<span class="sd">    :param Porosity: porosity of porous medium</span>
<span class="sd">    :type Porosity: u.dimensionless or unitless</span>

<span class="sd">    :return: Reynolds number for flow through porous media</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">ApproachVel</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;ApproachVel&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">DiamMedia</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;DiamMedia&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Porosity</span><span class="p">,</span> <span class="s2">&quot;0-1&quot;</span><span class="p">,</span> <span class="s2">&quot;Porosity&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ApproachVel</span> <span class="o">*</span> <span class="n">DiamMedia</span> <span class="o">/</span>
            <span class="p">(</span><span class="n">viscosity_kinematic_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span>
             <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Porosity</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>


<div class="viewcode-block" id="fric_ergun"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.fric_ergun">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fric_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the friction factor for flow through porous media.</span>

<span class="sd">    :param ApproachVel: superficial fluid velocity (VelSuperficial?)</span>
<span class="sd">    :type ApproachVel: u.m/u.s</span>
<span class="sd">    :param DiamMedia: particle diameter</span>
<span class="sd">    :type DiamMedia: u.m</span>
<span class="sd">    :param Temperature: temperature of porous medium</span>
<span class="sd">    :type Temperature: u.degK</span>
<span class="sd">    :param Porosity: porosity of porous medium</span>
<span class="sd">    :type Porosity: u.dimensionless or unitless</span>

<span class="sd">    :return: friction factor for flow through porous media</span>
<span class="sd">    :rtype: u.dimensionless</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">300</span> <span class="o">/</span> <span class="n">re_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span></div>


<div class="viewcode-block" id="headloss_ergun"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.headloss_ergun">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">headloss_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">,</span> <span class="n">Length</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the frictional head loss for flow through porous media.</span>

<span class="sd">    :param ApproachVel: superficial fluid velocity (VelSuperficial?)</span>
<span class="sd">    :type ApproachVel: u.m/u.s</span>
<span class="sd">    :param DiamMedia: particle diameter</span>
<span class="sd">    :type DiamMedia: u.m</span>
<span class="sd">    :param Temperature: temperature of porous medium</span>
<span class="sd">    :type Temperature: u.degK</span>
<span class="sd">    :param Porosity: porosity of porous medium</span>
<span class="sd">    :type Porosity: u.dimensionless or unitless</span>
<span class="sd">    :param Length: length of pipe or duct</span>
<span class="sd">    :type Length: u.m</span>

<span class="sd">    :return: frictional head loss for flow through porous media</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fric_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">Length</span> <span class="o">/</span> <span class="n">DiamMedia</span> <span class="o">*</span> <span class="n">ApproachVel</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Porosity</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">Porosity</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="g_cs_ergun"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.g_cs_ergun">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">g_cs_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Camp Stein velocity gradient for flow through porous media.</span>

<span class="sd">    :param ApproachVel: superficial fluid velocity (VelSuperficial?)</span>
<span class="sd">    :type ApproachVel: u.m/u.s</span>
<span class="sd">    :param DiamMedia: particle diameter</span>
<span class="sd">    :type DiamMedia: u.m</span>
<span class="sd">    :param Temperature: temperature of porous medium</span>
<span class="sd">    :type Temperature: u.degK</span>
<span class="sd">    :param Porosity: porosity of porous medium</span>
<span class="sd">    :type Porosity: u.dimensionless or unitless</span>

<span class="sd">    :return: Camp Stein velocity gradient for flow through porous media</span>
<span class="sd">    :rtype: u.Hz</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fric_ergun</span><span class="p">(</span><span class="n">ApproachVel</span><span class="p">,</span> <span class="n">DiamMedia</span><span class="p">,</span> <span class="n">Temperature</span><span class="p">,</span> <span class="n">Porosity</span><span class="p">)</span>
                   <span class="o">*</span> <span class="n">ApproachVel</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Porosity</span><span class="p">)</span>
                   <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">viscosity_kinematic_water</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span> <span class="o">*</span> <span class="n">DiamMedia</span>
                      <span class="o">*</span> <span class="n">Porosity</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span></div>

<span class="c1">######################## Miscellaneous ########################</span>


<div class="viewcode-block" id="height_water_critical"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.height_water_critical">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">height_water_critical</span><span class="p">(</span><span class="n">FlowRate</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the critical local water height.</span>

<span class="sd">    :param FlowRate: flow rate of water</span>
<span class="sd">    :type FlowRate: u.m**3/u.s</span>
<span class="sd">    :param Width: width of channel (????????)</span>
<span class="sd">    :type Width: u.m</span>

<span class="sd">    :return: critical water height</span>
<span class="sd">    :rtype: u.m</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">FlowRate</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Flow rate&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">Width</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Width&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">FlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">Width</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span></div>


<div class="viewcode-block" id="vel_horizontal"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.vel_horizontal">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">vel_horizontal</span><span class="p">(</span><span class="n">HeightWaterCritical</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the horizontal velocity. (at the critical water depth??????)</span>

<span class="sd">    :param HeightWaterCritical: critical water height</span>
<span class="sd">    :type HeightWaterCritical: u.m</span>

<span class="sd">    :return: horizontal velocity</span>
<span class="sd">    :rtype: u.m/u.s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">check_range</span><span class="p">([</span><span class="n">HeightWaterCritical</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s2">&quot;&gt;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Critical height of water&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">HeightWaterCritical</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="manifold_id_alt"><a class="viewcode-back" href="../../../core/physchem.html#aguaclara.core.physchem.manifold_id_alt">[docs]</a><span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">manifold_id_alt</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">pr_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the inner diameter of a manifold when major losses are</span>
<span class="sd">    negligible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">manifold_id_alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="mi">4</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">pr_max</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">manifold_id_alt</span></div>


<span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">manifold_id</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">q_ratio</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">id_new</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">inch</span>
    <span class="n">id_old</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">inch</span>
    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="n">id_old</span> <span class="o">=</span> <span class="n">id_new</span>
        <span class="n">id_new</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">((</span><span class="mi">8</span> <span class="o">*</span> <span class="n">q</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span>
            <span class="p">(</span>
                <span class="p">(</span>
                    <span class="mi">1</span> <span class="o">+</span> <span class="n">fric_pipe</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">id_old</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span> <span class="o">*</span>
                    <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
                <span class="p">)</span> <span class="o">/</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">q_ratio</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">id_old</span> <span class="o">-</span> <span class="n">id_new</span><span class="p">)</span> <span class="o">/</span> <span class="n">id_new</span>
    <span class="k">return</span> <span class="n">id_new</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">manifold_nd</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">q_ratio</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sdr</span><span class="p">):</span>
    <span class="n">manifold_nd</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">ND_SDR_available</span><span class="p">(</span>
            <span class="n">manifold_id</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">q_ratio</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
            <span class="n">sdr</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">manifold_nd</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">horiz_chan_w</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">hl</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">manifold</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">hl</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">hl</span><span class="p">,</span> <span class="n">depth</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">horiz_chan_w_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="p">((</span><span class="n">depth</span> <span class="o">-</span> <span class="n">hl</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">hl</span><span class="p">))</span>

    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">horiz_chan_w_new</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">horiz_chan_w_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span>
                    <span class="n">fric_rect</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="n">hl</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="n">hl</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span> <span class="o">*</span>
                    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">manifold</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)))</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">hl</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">/</span> <span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">hl</span><span class="p">))</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">horiz_chan_w_new</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">horiz_chan_w_new</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">horiz_chan_w_new</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">horiz_chan_h</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">hl</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">manifold</span><span class="p">):</span>
    <span class="n">h_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">hl</span><span class="p">)))</span> <span class="o">+</span> <span class="n">hl</span>
    <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mf">0.001</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h_new</span>
        <span class="n">hl_local</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">hl</span><span class="p">,</span> <span class="n">h</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">h_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">/</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> \
            <span class="n">fric_rect</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">hl_local</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> \
                <span class="n">radius_hydraulic_rect</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">hl_local</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">manifold</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">hl_local</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">hl_local</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h_new</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">h_new</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_new</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">list_handler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">pipe_flow_nd</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">sdr</span><span class="p">,</span> <span class="n">hl</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">id_sdr_all_available</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">ID_SDR_all_available</span><span class="p">(</span><span class="n">sdr</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">q</span> <span class="o">&gt;</span> <span class="n">flow_pipe</span><span class="p">(</span><span class="n">id_sdr_all_available</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hl</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">i_d</span> <span class="o">=</span> <span class="n">id_sdr_all_available</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">pipe</span><span class="o">.</span><span class="n">ND_SDR_available</span><span class="p">(</span><span class="n">i_d</span><span class="p">,</span> <span class="n">sdr</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, AguaClara Cornell

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>